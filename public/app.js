"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){t.module("webtrekk",["ui.router"]).config(["$urlServiceProvider","$locationProvider",function(t,e){"ngInject";e.html5Mode(!0)}])}(angular),function(t){function e(t,e,r){"ngInject";(function(){t.load(),this.user=t.byId[e.customerId]||{},this.user.birthday=new Date(this.user.birthday)}).call(this),this.save=function(){t.save(),r.go("customerlist()")}}e.$inject=["UsersData","$stateParams","$state"],t.module("webtrekk").controller("detailsController",e)}(angular),function(t){function e(t,e){"ngInject";t.state("customerDetails",{url:"/data/{customerId:[0-9]{1,8}}",template:"<details></details>"})}e.$inject=["$stateProvider","$urlServiceProvider"],t.module("webtrekk").config(e).directive("details",function(){return{templateUrl:"/details/details.html",scope:{},replace:!0,controllerAs:"$ctrl",controller:"detailsController"}})}(angular),angular.module("webtrekk").filter("ageFilter",function(){function t(t){if(!t)return"N/A";t.getTime||(t=new Date(t));var e=Date.now()-t.getTime(),r=new Date(e);return Math.abs(r.getUTCFullYear()-1970)}return function(e){return t(e)}}),angular.module("webtrekk").filter("genderFilter",function(){function t(t){if(!t)return"N/A";var e=String(t).toLowerCase();switch(["m","w"].indexOf(e)){case 0:return"Male";case 1:return"Female";default:return"N/A"}}return function(e){return t(e)}}),function(t){function e(t,e){"ngInject";e.rules.otherwise({state:"customerlist"}),t.state("customerlist",{url:"/",template:"<main></main>"})}e.$inject=["$stateProvider","$urlServiceProvider"],t.module("webtrekk").config(e).directive("main",function(){return{templateUrl:"/main/main.html",scope:{},replace:!0,controllerAs:"$ctrl",controller:"mainController"}})}(angular),function(t){function e(t,e,r){"ngInject";var n=this;t.load(),t.sortBy("last_name"),this.users=t.ids,this.UsersData=t,this.orderBy="last_name",this.reverseSort=!1,this.remove=function(e){t.remove(e),n.users=t.ids},this.sort=function(t){n.orderBy!==t?(n.orderBy=t,n.reverseSort=!1):n.reverseSort=!n.reverseSort;var e=n.reverseSort?"-":"";n.users=n.UsersData.sortBy(e+n.orderBy)}}e.$inject=["UsersData","$timeout","$scope"],t.module("webtrekk").controller("mainController",e)}(angular),function(t){function e(t,e){"ngInject";t.state("navi",{url:"/navi/{customerId:[0-9]{1,8}}",template:"<navi></navi>"})}e.$inject=["$stateProvider","$urlServiceProvider"],t.module("webtrekk").config(e).directive("navi",function(){return{templateUrl:"/navi/navi.html",scope:{},replace:!0,controllerAs:"$ctrl",controller:"navHistoryController"}})}(angular),function(){function t(t,e){"ngInject";(function(){t.load(),this.user=t.byId[e.customerId]||{},this.history=t.naviById[e.customerId],console.log(this,t)}).call(this)}t.$inject=["UsersData","$stateParams"],angular.module("webtrekk").controller("navHistoryController",t)}(angular),function(t){function e(t,e,r){"ngInject";return{get:function(){try{var n=JSON.parse(e.getItem(r));if(!n||(void 0===n?"undefined":_typeof(n))!==(void 0===t?"undefined":_typeof(t)))throw"no intialdata";return this._error=null,n}catch(e){return this._error?(this._error=null,console.warn("it looks like StorageEngine has failed... returning vanilla JS"),t):(this.set.call(this,t),this._error=e,this.get())}},set:function(t){e.setItem(r,JSON.stringify(t))},reload:function(){return this.set(t),this.get()}}}e.$inject=["initialState","StorageEngine","STORAGE_ID"],t.module("webtrekk").constant("StorageEngine",localStorage).constant("STORAGE_ID","webtrekk__local").constant("initialState",{master:[{customer_id:"1",first_name:"Peter",last_name:"Smith",birthday:"1996-10-12",gender:"m",last_contact:"2013-06-01",customer_lifetime_value:"191,12"},{customer_id:"2",first_name:"Anna",last_name:"Hopp",birthday:"1987-05-03",gender:"w",last_contact:"2013-07-08",customer_lifetime_value:"50,99"},{customer_id:"3",first_name:"Christian",last_name:"Cox",birthday:"1991-02-21",gender:"m",last_contact:"2013-08-01",customer_lifetime_value:"0"},{customer_id:"4",first_name:"Roxy",last_name:"Fox",birthday:"1979-06-30",gender:"w",last_contact:"2012-01-29",customer_lifetime_value:"213,12"},{customer_id:"5",first_name:"Eric",last_name:"Adam",birthday:"1969-11-21",gender:"m",last_contact:"2013-03-18",customer_lifetime_value:"1019,91"}],navi:[{customer_id:"1",pages:"A",timestamp:"2013-06-01 10:10:12"},{customer_id:"1",pages:"B",timestamp:"2013-06-01 10:11:12"},{customer_id:"1",pages:"A",timestamp:"2013-06-01 10:12:12"},{customer_id:"2",pages:"C",timestamp:"2013-07-08 09:03:09"},{customer_id:"2",pages:"A",timestamp:"2013-07-08 09:09:09"},{customer_id:"2",pages:"D",timestamp:"2013-07-08 09:19:09"},{customer_id:"3",pages:"B",timestamp:"2013-07-08 09:19:09"},{customer_id:"3",pages:"A",timestamp:"2013-07-08 09:19:10"},{customer_id:"4",pages:"D",timestamp:"2013-07-08 09:19:11"},{customer_id:"4",pages:"A",timestamp:"2013-07-08 09:19:12"},{customer_id:"5",pages:"X",timestamp:"2013-07-08 09:19:13"},{customer_id:"5",pages:"A",timestamp:"2013-07-08 09:19:14"},{customer_id:"5",pages:"B",timestamp:"2013-07-08 09:19:15"}]}).factory("$wt_storage",e)}(angular),function(){function t(t){"ngInject";function e(){var e=t.get();return this.byId=e.master.reduce(a,{}),this.naviById=e.navi.reduce(s,{}),this.ids=Object.keys(this.byId),this}function r(t,e){var r=1;return"-"===t[0]&&(r=-1,t=t.substr(1)),function(n,a){if(e){var s=e[n],i=e[a];return(s[t]<i[t]?-1:s[t]>i[t]?1:0)*r}return(n[t]<a[t]?-1:n[t]>a[t]?1:0)*r}}var n=this;this.load=e.bind(this),this.byId={},this.naviById={},this.ids=[],this.sortBy=function(t){return this.ids=this.ids.sort(r(t,this.byId)),this.ids}.bind(this),this.save=function(e){var r={master:Object.values(this.byId),navi:Object.values(this.naviById).reduce(function(t,e){return t.concat(e)},[])};t.set(r),console.log("saved data")}.bind(this),this.remove=function(r){console.log("removing id",r);var n={master:Object.values(this.byId).filter(function(t){return t.customer_id!==r}),navi:Object.values(this.naviById).reduce(function(t,e){return t.concat(e)},[]).filter(function(t){return t.customer_id!==r})};t.set(n),e.call(this)}.bind(this),this.getNavigation=function(t){return n.naviById[t]},this._dynamicSort=r;var a=function(t,e){return e.birthday=new Date(e.birthday),e.last_contact=new Date(e.last_contact),t[e.customer_id]=e,t},s=function(t,e){return e.timestamp=new Date(e.timestamp),t[e.customer_id]?t[e.customer_id].push(e):t[e.customer_id]=[e],t}}t.$inject=["$wt_storage"],angular.module("webtrekk").service("UsersData",t)}(),angular,function(t){t.module("webtrekk").run(["$templateCache",function(t){t.put("/navi/navi.html",'<div class="has__form">\n <h1 ng-if="$ctrl.user.customer_id">{{$ctrl.user.first_name}} {{$ctrl.user.last_name}} Navigation history</h1>\n <h1 ng-if="!$ctrl.user.customer_id">no valid user id provided</h1>\n\n <table id="main_overview_table" class="table table-sm table-hover table-striped table-bordered" style="margin:20px auto">\n <caption style="caption-side:top;">\n <h1>Customer Overview</h1>\n <a ui-sref="customerlist()" class="btn btn-primary">\n back\n <span class="badge badge-secondary">{{$ctrl.count}}+</span>\n </a>\n </caption>\n <thead class="thead-inverse">\n <tr>\n <th>Pages</th>\n <th>Time stamp</th>\n </tr>\n </thead>\n <tbody>\n <tr ng-repeat="entry in $ctrl.history">\n <th>{{entry.pages}}</th>\n <th>{{entry.timestamp}}</th>\n </tr>\n </tbody>\n </table>\n\n</div>'),t.put("/main/main.html",'<table id="main_overview_table" class="table table-sm table-hover table-striped table-bordered" style="margin:20px auto">\n <caption style="caption-side:top;">\n <h1>Customer Overview</h1>\n <a ui-sref="customerDetails({customerId: 0})" class="btn btn-primary">\n Create new customer\n <span class="badge badge-secondary">{{$ctrl.count}}+</span>\n </button>\n </caption>\n <thead class="thead-inverse">\n <tr>\n <th>\n <a style="color:white" href="#" ng-click="$ctrl.sort(\'first_name\')" >\n First Name\n <span ng-show="orderBy == \'firstName\'">\n <span ng-show="!$ctrl.reverseSort">^</span>\n <span ng-show="$ctrl.reverseSort">v</span>\n </span>\n </a>\n </th>\n <th>\n <a style="color:white" href="#" ng-click="$ctrl.sort(\'last_name\')">\n Last Name\n <span ng-show="orderBy == \'last_name\'">\n <span ng-show="!$ctrl.reverseSort">^</span>\n <span ng-show="$ctrl.reverseSort">v</span>\n </span>\n </a>\n </th>\n <th>\n <a style="color:white" href="#" ng-click="$ctrl.sort(\'birthday\')" >\n Age\n <span ng-show="orderBy == \'birthday\'">\n <span ng-show="!$ctrl.reverseSort">^</span>\n <span ng-show="$ctrl.reverseSort">v</span>\n </span>\n </a>\n </th>\n <th>\n <a style="color:white" href="#" ng-click="$ctrl.sort(\'gender\')" >\n Gender\n <span ng-show="orderBy == \'gender\'">\n <span ng-show="!$ctrl.reverseSort">^</span>\n <span ng-show="$ctrl.reverseSort">v</span>\n </span>\n </a>\n </th>\n <th>options</th>\n </tr>\n </thead>\n <tr ng-repeat="id in $ctrl.users">\n <td> {{::$ctrl.UsersData.byId[id].first_name}} </td>\n <td> {{::$ctrl.UsersData.byId[id].last_name}} </td>\n <td> {{::$ctrl.UsersData.byId[id].birthday|ageFilter}} </td>\n <td> {{::$ctrl.UsersData.byId[id].gender|genderFilter}} </td>\n <td>\n <div class="flex__row">\n <a ui-sref="customerDetails({customerId: id})" class="btn btn-primary">\n Edit\n </a>\n <button class="btn btn-primary" ng-click="$ctrl.remove(id)">\n Delete\n </button>\n <a ui-sref="navi({customerId: id})" class="btn btn-success">\n Navi\n </a>\n </div>\n </td>\n </tr>\n</table>'),t.put("/details/details.html",'<div class="has__form">\n <h1 ng-if="$ctrl.user.customer_id">{{$ctrl.user.first_name}} {{$ctrl.user.last_name}} Details</h1>\n <h1 ng-if="!$ctrl.user.customer_id">Create New user</h1>\n\n <form>\n <div class="form-group" ng-if="$ctrl.user.customer_id">\n <label for="customer_id">customer id</label>\n <input type="number" class="form-control" id="customer_id" disabled ng-value="{{$ctrl.user.customer_id/1}}" placeholder="customer_id">\n <small ng-if="$ctrl.errors.customer_id" id="customer_idHelp" class="form-text text-danger">{{$ctrl.errors.customer_id}}</small>\n </div>\n\n <div class="form-group">\n <label for="first_name">first name</label>\n <input type="string" class="form-control" id="first_name" ng-model="$ctrl.user.first_name" placeholder="first_name">\n <small ng-if="$ctrl.errors.first_name" id="first_nameHelp" class="form-text text-danger">{{$ctrl.errors.first_name}}</small>\n </div>\n \n <div class="form-group">\n <label for="last_name">last name</label>\n <input type="string" class="form-control" id="last_name" ng-model="$ctrl.user.last_name" placeholder="last_name">\n <small ng-if="$ctrl.errors.last_name" id="last_nameHelp" class="form-text text-danger">{{$ctrl.errors.last_name}}</small>\n </div>\n\n <div class="form-group">\n <label for="birthday">birthday</label>\n <input\n placeholder="yyyy-MM-dd"\n min="1970-01-01" max="2017-12-22" required type="date" class="form-control" id="birthday" ng-model="$ctrl.user.birthday" placeholder="birthday">\n <small ng-if="$ctrl.errors.birthday" id="birthdayHelp" class="form-text text-danger">{{$ctrl.errors.birthday}}</small>\n </div>\n \n <div class="form-group">\n <label for="gender">gender</label>\n <select name="gender" class="form-control" ng-model="$ctrl.user.gender">\n <option value="m">Male</option>\n <option value="w">Female</option>\n </select>\n </div>\n \n <div class="form-group">\n <label for="last_contact">last contact</label>\n <input ng-disabled="!$ctrl.user.customer_id" type="date" class="form-control" id="last_contact" ng-model="$ctrl.user.last_contact" placeholder="last_contact">\n <small ng-if="$ctrl.errors.last_contact" id="last_contactHelp" class="form-text text-danger">{{$ctrl.errors.last_contact}}</small>\n </div>\n \n <div class="form-group">\n <label for="customer_lifetime_value">customer lifetime_value</label>\n <input type="string" class="form-control" id="customer_lifetime_value" ng-model="$ctrl.user.customer_lifetime_value" placeholder="customer_lifetime_value">\n <small ng-if="$ctrl.errors.customer_lifetime_value" id="customer_lifetime_valueHelp" class="form-text text-danger">{{$ctrl.errors.customer_lifetime_value}}</small>\n </div>\n\n <hr/>\n <div style="min-width:100%">\n <button class="btn btn-primary" ng-click="$ctrl.save()">\n save and go back\n </button>\n <a ui-sref="customerlist()" class="btn btn-dark">\n cancel\n </a>\n </div>\n </form>\n</div>')}])}(angular);